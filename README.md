# Walking Experiment 2512

モバイル位置情報データに基づく観光スポットと訪問者の同時クラスタリング

## 概要

このプロジェクトは、根本ら (2023) の論文「モバイル位置情報データに基づく観光スポットと訪問者の同時クラスタリングと個人的穴場の抽出」の手法を Python で再実装したものです。

論文では LocalSolver という数理最適化ソルバを使用していますが、本実装では Python の最適化アルゴリズム（貪欲法）を使用しています。

## 主な機能

1. **二部グラフのクラスタリング**: 観光スポットと訪問者を同時にクラスタリング
2. **重複を考慮**: 1つのノードが複数のクラスターに属することを許容
3. **個人的穴場の抽出**: 特定の訪問者集団に対する穴場スポットを抽出
4. **可視化**: クラスター分布、カテゴリ分布、穴場スポットの可視化

## セットアップ

```bash
task install
```

または

```bash
uv sync
```

## 使用方法

### データ生成

```bash
task generate
```

### クラスタリングの実行

```bash
task cluster
```

または

```bash
uv run python bipartite_clustering.py
```

生成されるファイル（`output/`ディレクトリ内）:
- `clustering_results.json`: クラスタリング結果

### 可視化

```bash
task visualize
```

または

```bash
uv run python visualize_clusters.py
```

生成されるファイル（`output/`ディレクトリ内）:
- `cluster_distribution.png`: クラスター別の観光スポット数とトリップ数
- `category_distribution.png`: クラスター別のカテゴリ分布（ヒートマップ）
- `secret_spots_cluster3.png`: 個人的穴場の可視化

### クラスタリングと可視化を一度に実行

```bash
task analyze
```

## 数理モデル

### 二部グラフの構築

- **ノード**: 観光スポット（位置情報で識別）と訪問者/トリップ
- **エッジ**: 訪問者が観光スポットを訪問した場合に1、そうでない場合に0

### クラスター類似度

クラスター組み合わせ p と q の類似度:

```
g_pq = |p ∩ q| / √(|p| × |q|)
```

### 目的関数

同一クラスター内のエッジ密度 f_in を最大化し、異なるクラスター間のエッジ密度 f_out を最小化:

```
max ln(f_in) - ln(f_out)
```

### 個人的穴場の定義

特定のクラスターに対して:
- **独占的な穴場**: クラスター内で人気、全体では不人気
- **発見的な穴場**: クラスター内で不人気、全体では人気

## データ形式

入力データは以下のJSON形式:

```json
{
  "sessions": [
    {
      "id": "session-id",
      "user_id": "user-id",
      "records": [
        {
          "id": "record-id",
          "timestamp": "ISO-8601形式",
          "latitude": 緯度,
          "longitude": 経度,
          "category": "カテゴリ名"
        }
      ]
    }
  ]
}
```

## 参考文献

根本侑弥, 羽佐田紘之, 伊藤真利子, 長橋陽介, 岩瀬義和, 本間裕大 (2023). モバイル位置情報データに基づく観光スポットと訪問者の同時クラスタリングと個人的穴場の抽出. 都市計画論文集, 58(3), 1156-1163.

## ライセンス

&copy; 2025 Kanta Oikawa
